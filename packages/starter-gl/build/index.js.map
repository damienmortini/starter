{"version":3,"file":"index.js","sources":["../src/View.js","../src/index.js"],"sourcesContent":["import Camera from '@damienmortini/lib/3d/Camera.js';\nimport GLBoxObject from '@damienmortini/lib/gl/objects/GLBoxObject.js';\nimport TrackballController from '@damienmortini/lib/3d/controllers/TrackballController.js';\nimport GLProgram from '@damienmortini/lib/gl/GLProgram.js';\nimport BasicShader from '@damienmortini/lib/shader/BasicShader.js';\n\nexport default class View {\n  constructor({\n    canvas,\n  }) {\n    this.canvas = canvas;\n\n    const webGLOptions = {\n      depth: true,\n      alpha: false,\n      antialias: true,\n    };\n\n    if (!/\\bforcewebgl1\\b/.test(window.location.search)) {\n      this.gl = this.canvas.getContext('webgl2', webGLOptions);\n    }\n    if (!this.gl) {\n      this.gl = this.canvas.getContext('webgl', webGLOptions) || this.canvas.getContext('experimental-webgl', webGLOptions);\n    }\n\n    this.camera = new Camera();\n\n    this.cameraController = new TrackballController({\n      domElement: this.canvas,\n      matrix: this.camera.transform,\n      distance: 5,\n    });\n\n    this.gl.clearColor(0, 0, 0, 1);\n    this.gl.enable(this.gl.CULL_FACE);\n    this.gl.enable(this.gl.DEPTH_TEST);\n\n    this.object = new GLBoxObject({\n      gl: this.gl,\n      width: 1,\n      height: 1,\n      normals: true,\n      program: new GLProgram({\n        gl: this.gl,\n        shader: new BasicShader({\n          normals: true,\n          fragmentChunks: [\n            ['end', `\n              fragColor = vec4(vNormal * .5 + .5, 1.);\n            `],\n          ],\n        }),\n      }),\n    });\n  }\n\n  resize(width, height) {\n    this.gl.viewport(0, 0, this.gl.drawingBufferWidth, this.gl.drawingBufferHeight);\n    this.camera.aspectRatio = width / height;\n    this.update();\n  }\n\n  update() {\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.DEPTH_BUFFER_BIT);\n\n    this.cameraController.update();\n\n    this.object.draw({\n      uniforms: {\n        projectionView: this.camera.projectionView,\n      },\n    });\n  }\n}\n","import AnimationTickerElement from '@damienmortini/element-animation-ticker/index.js';\n\nimport View from './View.js';\n\n/**\n * Entry point element\n * @hideconstructor\n * @example\n * <starter-gl></starter-gl>\n */\nclass Main extends AnimationTickerElement {\n  constructor() {\n    super();\n\n    this.autoplay = true;\n\n    this._resizeBinded = this.resize.bind(this);\n\n    this.attachShadow({ mode: 'open' }).innerHTML = `\n      <style>\n        :host {\n          display: block;\n          touch-action: none;\n        }\n        \n        canvas {\n          width: 100%;\n          height: 100%;\n          max-height: 100%;\n        }\n      </style>\n      <canvas></canvas>\n    `;\n\n    this.canvas = this.shadowRoot.querySelector('canvas');\n\n    this.view = new View({ canvas: this.canvas });\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener('resize', this._resizeBinded);\n    this.resize();\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    window.removeEventListener('resize', this._resizeBinded);\n  }\n\n  resize() {\n    const width = this.canvas.offsetWidth;\n    const height = this.canvas.offsetHeight;\n\n    this.canvas.width = width * window.devicePixelRatio;\n    this.canvas.height = height * window.devicePixelRatio;\n\n    this.view.resize(width, height);\n  }\n\n  update() {\n    this.view.update();\n  }\n}\n\nwindow.customElements.define('starter-gl', Main);\n"],"names":[],"mappings":"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"}